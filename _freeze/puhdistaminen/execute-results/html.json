{
  "hash": "db04d1a6197d9208cb92329c383048ec",
  "result": {
    "markdown": "# Puhdistaminen {#sec-puhdistaminen}\n\n\n---\neval: true\n---\n\n\nTässä osiossa puhdistamme datatiedostosta joitain virheellisiä kyselyvastauksia sekä tarkistamme puuttuvien vastausten piirteet.\n\nOsion käyttämä aineisto ei ole saatavilla tietosuojan takia.\n\n## Esivalmistelu {#sec-puhdistaminen-esivalmistelu}\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Osiossa käytetyt paketit\"}\nlibrary(tidyverse) # Datakäsittely\nlibrary(mice) # Puuttuvien vastausten analyysi\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Datan avaaminen\"}\ndata <- read.csv2(\"output/koodattudata.csv\", tryLogical = FALSE)\n```\n:::\n\n\n## Suostumuksensa kieltäneiden poistaminen {#sec-puhdistaminen-suostumuskiellot}\n\nEnnen poistamista datatiedostossa oli 1048 vastaajaa. Webropolissa tapahtuneen virheen takia kuitenkin osa vastaajista onnistuivat palauttamaan kyselylomakkeen, vaikka he eivät antaneet suostumusta tietojen käsittelyyn. Näillä vastaajilla ei ollut muuta tietoa, kuin `k1 == 2`, ja heidät poistettiin datatiedostosta.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Suostumuksensa kieltäneiden poistaminen aineistosta\"}\n# Otetaan mukaan vain suostumuksensa antaneet vastaajat\ndata <- data |>\n  dplyr::filter(k1 == 1)\n```\n:::\n\n\nPoistamisen jälkeen datatiedostossa oli 1025 vastaajaa.\n\n## Puuttuvien vastausten piirreanalyysi {#sec-puhdistaminen-puuttuvat}\n\nTarkistimme puuttuvien vastausten piirteet `mice`-paketin `md.pattern`-toiminnolla. Piirteet luokiteltiin eri yhdistelmiin olemassaolevista ja puuttuvista vastauksista, ja niiden esiintymismäärät laskettiin yhteen. Tarkastimme näistä eniten esiintyvät puuttuvien muuttujien yhdistelmät.\n\n\n::: {#tbl-puhdistaminen-puuttuvatpiirre .cell tbl-cap='Yleisimmän puuttuvien vastausten piirteessä esiintyvät puuttuvat muuttujat'}\n\n```{.r .cell-code  code-summary=\"Piirreanalyysi ja taulukon rakentaminen\"}\npuuttuvat <- data |>\n  mice::md.pattern(plot = FALSE) |>\n  as_tibble(rownames = \"Määrä\")\npuuttuvat$Määrä <- as.numeric(puuttuvat$Määrä)\n\npuuttuvat |>\n  filter(Määrä == 91) |>\n  t() |>\n  as.data.frame() |>\n  rownames_to_column() |>\n  filter(V1 == 0) |>\n  knitr::kable()\n```\n\n::: {.cell-output-display}\n|rowname | V1|\n|:-------|--:|\n|k43_1   |  0|\n|k43_2   |  0|\n|k43_3   |  0|\n|k43_4   |  0|\n|k43_5   |  0|\n|k43_6   |  0|\n|k43_7   |  0|\n|k43_8   |  0|\n|k43_9   |  0|\n|k43_10  |  0|\n|k43_11  |  0|\n|k43_12  |  0|\n|k43_13  |  0|\n|k43_14  |  0|\n|k43_15  |  0|\n|k43_16  |  0|\n|k43_17  |  0|\n|k43_18  |  0|\n|k42_3_1 |  0|\n|k42_1_1 |  0|\n|k42_2_1 |  0|\n|k42_1_2 |  0|\n|k42_1_3 |  0|\n|k42_3_2 |  0|\n|k42_2_3 |  0|\n|k42_2_2 |  0|\n|k42_3_3 |  0|\n:::\n:::\n\n\nPuuttuvien vastausten uniikkeja muuttujayhdistelmiä oli yhteensä 895 kappaletta.\n\nYleisimmällä puuttivien vastausten yhdistelmällä oli 91 vastaajaa (yhdistelmä A). Tältä muuttujayhdistelmältä puuttui vastaukset kaikilta työuran muutossuunnitelmien muuttujilta (`k42_X_X`), ja siten myös kaikilta muutosaiesyymuuttujilta (`k43_X`). Toisin sanoen, nämä 91 vastaajaa eivät olleet suunnitelleet mitään muutoksia toimintaan osallistumiseensa, mutta olivat vastanneet kaikkiin muihin kyselyn kysymyksiin. Puutteet ovat valideja puuttumisia, joten emme poistaneet vastaajia aineistosta.\n\nMuut yhdistelmät tippuvat alle 10 vastaajan. Emme käsitelleet näitä muuttujayhdistelmiä niiden harvinaisuuden takia.\n\n## Datan tallennus {#sec-puhdistaminen-tallennus}\n\nViimeiseksi data tallennettiin tilapäiseksi tiedostoksi anonymisointia varten.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-summary=\"Datan tallennus\"}\nwrite.csv2(data, file = \"output/puhdistettudata.csv\", row.names = FALSE)\n```\n:::\n",
    "supporting": [
      "puhdistaminen_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}