# Meta-analyysi {#sec-metaanalyysi}

---
eval: true
---

Sisällytimme meta-analyysiin kirjallisuuskatsauksesta 33 tutkimusta, jotka täyttivät seuraavat kriteerit:

1.  Estimoi epäasiallisen tai väkivaltaisen kohtelun esiintyvyyden määrällisesti
2.  Estimaatit ovat joko absoluuttisia määriä (n) tai relatiivisia lukuja (prosenttiarvoja)
3.  Estimaatit raportoidaan tekstissä, kuvissa, taulukoissa tai liitetiedostoissa
4.  Tutkimuksen kohderyhmä on pelastusalan ja/tai ensihoidon henkilöstö
5.  Tutkimus ei ole rekisteritutkimus tai rekisterin kaltainen tutkimus

Seulosimme kaikki kriteerit täyttävät tutkimukset läpi ja keräsimme Excel-taulukkoon tutkimusten jokaisen estimaatin arvon sekä estimaatin otoskoko. Jos tutkimus raportoi sisäistä katoa, käytimme estimaattikohtaista otoskokoa; jos katoa ei raportoitu, käytimme tutkimuksen (tai sen relevanttien kohderyhmien) otoskokoa.

Luokittelimme kaikki estimaatit väkivaltaluokituksen mukaisesti [@bildjuschkin2019]. Jätimme pois kaikki estimaatit, jotka käsittelivät "Muu"-luokkia.

Kuudelle estimaatille emme voineet antaa yksiselitteistä luokkaa. Jätimme nämä estimaatit analyysin ulkopuolelle:

-   "Verbaalinen ja fyysinen väkivalta" [@bernaldo-de-quirós2015]
-   "Seksuaalinen tai taloudellinen väkivalta" [@gümüssoy2021]
-   "Fyysinen väkivalta tai sen uhka" [@heikkinen2023]
-   "Aseella uhkaaminen tai päälle käyminen" [@immonen2019]
-   "Teräaseen tai muun välineen käyttö tai sillä uhkailu" [@kiviniemi2021]
-   "Verbaalinen kaltoinkohtelu (törkeä kieli, loukkaavat sanonnat sisältäen seksuaaliset, nolottavat lauseet; törkeät kommentit)" [@shkatula2019]

## Datavalmistelu

```{r}
library(tidyverse)
library(metafor)
metadata <- read.csv2("data/metaanalyysidata.csv") %>%
  dplyr::filter(!stringr::str_detect(väkivaltamuoto, ","))
metadata <- metadata %>%
  tibble::rowid_to_column("ID")
```

Muunsimme ensin kaikki prosenttiluvut logit-luvuiksi ja laskimme niiden keskivirheet. Tämä muunnos tehdään, jotta voimme suorittaa monitasoisen meta-analyysin myöhemmin.

```{r}
metadata <- metadata %>%
  add_column(
    pros_log = numeric(nrow(metadata)),
    pros_sqrtse = numeric(nrow(metadata))
  )
metadata <- metadata %>%
  dplyr::select(ID, otoskoko, pros) %>%
  dplyr::filter(pros != 0) %>%
  dplyr::mutate(
    pros_log = log(pros/(1-pros)),
    pros_sqrtse = (1/(otoskoko*pros))+(1/(otoskoko*(1-pros)))
  ) %>%
  dplyr::rows_update(
    x = metadata,
    y = .,
    by = "ID",
    copy = TRUE
  )
```

Asetimme sitten jokaiselle väkivaltamuodolle oman kolmitasoisen meta-analyyttisen mallin `metafor`-paketin avulla.

```{r}
#| label: tulokset

tulokset <- tibble(
  muoto = character(),
  arvo = numeric(),
  ci_ala = numeric(),
  ci_ylä = numeric()
)
```

```{r}
#| label: malli_fyysinen
malli_fyysinen <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Fyysinen"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Fyysinen",
    arvo = as.double(exp(malli_fyysinen$b) / (1 + exp(malli_fyysinen$b))),
    ci_ala = as.double(exp(malli_fyysinen$ci.lb) / (1 + exp(malli_fyysinen$ci.lb))),
    ci_ylä = as.double(exp(malli_fyysinen$ci.ub) / (1 + exp(malli_fyysinen$ci.ub)))
  )
```

```{r}
#| label: malli_henkinen
malli_henkinen <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Henkinen"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Henkinen",
    arvo = as.double(exp(malli_henkinen$b) / (1 + exp(malli_henkinen$b))),
    ci_ala = as.double(exp(malli_henkinen$ci.lb) / (1 + exp(malli_henkinen$ci.lb))),
    ci_ylä = as.double(exp(malli_henkinen$ci.ub) / (1 + exp(malli_henkinen$ci.ub)))
  )
```

```{r}
#| label: malli_seksuaalinen
malli_seksuaalinen <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Seksuaalinen"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Seksuaalinen",
    arvo = as.double(exp(malli_seksuaalinen$b) / (1 + exp(malli_seksuaalinen$b))),
    ci_ala = as.double(exp(malli_seksuaalinen$ci.lb) / (1 + exp(malli_seksuaalinen$ci.lb))),
    ci_ylä = as.double(exp(malli_seksuaalinen$ci.ub) / (1 + exp(malli_seksuaalinen$ci.ub)))
  )
```

```{r}
#| label: malli_välineellinen
malli_välineellinen <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Välineellinen"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Välineellinen",
    arvo = as.double(exp(malli_välineellinen$b) / (1 + exp(malli_välineellinen$b))),
    ci_ala = as.double(exp(malli_välineellinen$ci.lb) / (1 + exp(malli_välineellinen$ci.lb))),
    ci_ylä = as.double(exp(malli_välineellinen$ci.ub) / (1 + exp(malli_välineellinen$ci.ub)))
  )
```

```{r}
#| label: malli_kemiallinen
malli_kemiallinen <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Kemiallinen"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Kemiallinen",
    arvo = as.double(exp(malli_kemiallinen$b) / (1 + exp(malli_kemiallinen$b))),
    ci_ala = as.double(exp(malli_kemiallinen$ci.lb) / (1 + exp(malli_kemiallinen$ci.lb))),
    ci_ylä = as.double(exp(malli_kemiallinen$ci.ub) / (1 + exp(malli_kemiallinen$ci.ub)))
  )
```

```{r}
#| label: malli_syrjintä
malli_syrjintä <- metafor::rma.mv(
  yi = pros_log,
  V = pros_sqrtse,
  slab = artikkeli,
  data = dplyr::filter(metadata, väkivaltamuoto == "Syrjintä"),
  random = ~ 1 | artikkeli/ID,
  test = "t",
  method = "REML"
)

tulokset <- tulokset %>%
  add_case(
    muoto = "Syrjintä",
    arvo = as.double(exp(malli_syrjintä$b) / (1 + exp(malli_syrjintä$b))),
    ci_ala = as.double(exp(malli_syrjintä$ci.lb) / (1 + exp(malli_syrjintä$ci.lb))),
    ci_ylä = as.double(exp(malli_syrjintä$ci.ub) / (1 + exp(malli_syrjintä$ci.ub)))
  )
```

Tulokset ovat esitettynä alla olevassa taulukossa (@tbl-tulokset) ja kuviossa (@fig-tulokset).

```{r}
#| label: tbl-tulokset
#| tbl-cap: "Meta-analyysin arvioimat esiintymismuodot ja niiden luottamusvälit (95 %) desimaaleina"

knitr::kable(tulokset)
```

```{r}
#| label: fig-tulokset
#| fig-cap: "Meta-analyysin arvioimat esiintyvyydet ja niiden luottamusvälit (95 %) desimaaleissa"

ggplot(tulokset) +
  aes(x = muoto, y = arvo, fill = muoto) +
  geom_col() +
  geom_errorbar(aes(ymin = ci_ala, ymax = ci_ylä)) + 
  labs(
    x = "Väkivaltamuoto",
    y = "Esiintyvyys",
    fill = "Väkivaltamuoto"
  )
```
